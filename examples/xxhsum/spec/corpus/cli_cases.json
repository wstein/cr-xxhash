[
    {
        "name": "hashes a file with default algorithm",
        "args": [
            "alpha.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 0,
        "stdout_snapshot": "hash_default.stdout.snap",
        "stderr_snapshot": "hash_default.stderr.snap"
    },
    {
        "name": "hashes a file with xxh3",
        "args": [
            "-H3",
            "alpha.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 0,
        "stdout_snapshot": "hash_h3.stdout.snap",
        "stderr_snapshot": "hash_h3.stderr.snap"
    },
    {
        "name": "hashes piped stdin payload",
        "args": [],
        "stdin_fixture": "stdin_payload.txt",
        "stdin_tty": false,
        "expected_exit": 0,
        "stdout_snapshot": "hash_stdin.stdout.snap",
        "stderr_snapshot": "hash_stdin.stderr.snap"
    },
    {
        "name": "prints help when no args and tty stdin",
        "args": [],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 1,
        "stdout_snapshot": "help_no_args.stdout.snap",
        "stderr_snapshot": "help_no_args.stderr.snap"
    },
    {
        "name": "verifies checksums from checksum file",
        "args": [
            "-c",
            "checksums_gnu.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 0,
        "stdout_snapshot": "check_file.stdout.snap",
        "stderr_snapshot": "check_file.stderr.snap"
    },
    {
        "name": "verifies checksums from piped stdin",
        "args": [
            "-c"
        ],
        "stdin_fixture": "checksums_h3_stdin.txt",
        "stdin_tty": false,
        "expected_exit": 0,
        "stdout_snapshot": "check_stdin.stdout.snap",
        "stderr_snapshot": "check_stdin.stderr.snap"
    },
    {
        "name": "fails strict mode on malformed checksum line",
        "args": [
            "-c",
            "--strict",
            "checksums_bad.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 2,
        "stdout_snapshot": "check_strict_bad.stdout.snap",
        "stderr_snapshot": "check_strict_bad.stderr.snap"
    },
    {
        "name": "detects modified file in checksum verification",
        "args": [
            "-c",
            "mutable_checksum.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "mutations": [
            {
                "file": "mutable.txt",
                "content": "MODIFIED CONTENT\n"
            }
        ],
        "expected_exit": 1,
        "stdout_snapshot": "check_mutation_modified.stdout.snap",
        "stderr_snapshot": "check_mutation_modified.stderr.snap"
    },
    {
        "name": "detects multiple modified files in batch check",
        "args": [
            "-c",
            "checksums_gnu.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "mutations": [
            {
                "file": "alpha.txt",
                "content": "CORRUPTED ALPHA\n"
            },
            {
                "file": "beta.txt",
                "content": "CORRUPTED BETA\n"
            }
        ],
        "expected_exit": 1,
        "stdout_snapshot": "check_mutation_batch.stdout.snap",
        "stderr_snapshot": "check_mutation_batch.stderr.snap"
    },
    {
        "name": "detects single corruption in H3 batch via stdin",
        "args": [
            "-c"
        ],
        "stdin_fixture": "checksums_h3_stdin.txt",
        "stdin_tty": false,
        "mutations": [
            {
                "file": "alpha.txt",
                "content": "corrupted\n"
            }
        ],
        "expected_exit": 1,
        "stdout_snapshot": "check_mutation_h3_stdin.stdout.snap",
        "stderr_snapshot": "check_mutation_h3_stdin.stderr.snap"
    },
    {
        "name": "check: missing file without --ignore-missing",
        "args": [
            "-c",
            "checksums_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 1,
        "stdout_snapshot": "check_missing.stdout.snap",
        "stderr_snapshot": "check_missing.stderr.snap"
    },
    {
        "name": "check: missing file with --ignore-missing",
        "args": [
            "-c",
            "--ignore-missing",
            "checksums_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 1,
        "stdout_snapshot": "check_missing_ignore.stdout.snap",
        "stderr_snapshot": "check_missing_ignore.stderr.snap"
    },
    {
        "name": "check: missing file with -q (quiet)",
        "args": [
            "-c",
            "-q",
            "checksums_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 1,
        "stdout_snapshot": "check_missing_quiet.stdout.snap",
        "stderr_snapshot": "check_missing_quiet.stderr.snap"
    },
    {
        "name": "check: missing file with --ignore-missing + -q",
        "args": [
            "-c",
            "--ignore-missing",
            "-q",
            "checksums_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 1,
        "stdout_snapshot": "check_missing_ignore_quiet.stdout.snap",
        "stderr_snapshot": "check_missing_ignore_quiet.stderr.snap"
    },
    {
        "name": "check: mixed present + missing without flags",
        "args": [
            "-c",
            "checksums_mixed_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 1,
        "stdout_snapshot": "check_mixed_missing.stdout.snap",
        "stderr_snapshot": "check_mixed_missing.stderr.snap"
    },
    {
        "name": "check: mixed present + missing with --ignore-missing",
        "args": [
            "-c",
            "--ignore-missing",
            "checksums_mixed_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 0,
        "stdout_snapshot": "check_mixed_missing_ignore.stdout.snap",
        "stderr_snapshot": "check_mixed_missing_ignore.stderr.snap"
    },
    {
        "name": "check: mixed present + missing with -q",
        "args": [
            "-c",
            "-q",
            "checksums_mixed_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 1,
        "stdout_snapshot": "check_mixed_missing_quiet.stdout.snap",
        "stderr_snapshot": "check_mixed_missing_quiet.stderr.snap"
    },
    {
        "name": "check: mixed present + missing with --ignore-missing + -q",
        "args": [
            "-c",
            "--ignore-missing",
            "-q",
            "checksums_mixed_missing.txt"
        ],
        "stdin_fixture": null,
        "stdin_tty": true,
        "expected_exit": 0,
        "stdout_snapshot": "check_mixed_missing_ignore_quiet.stdout.snap",
        "stderr_snapshot": "check_mixed_missing_ignore_quiet.stderr.snap"
    }
]